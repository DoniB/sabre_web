webpackJsonp([0],{"7PBn":function(t,e){},"9e/E":function(t,e){},L4Tr:function(t,e){},mDmC:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("ks6x"),n=s("rEVH"),r={mixins:[n.a],props:["comment"],methods:{destroy:function(){var t=this;console.log(this.remote.recipes.comments.delete(this.$store.state.secureToken,this.comment,function(e){t.$emit("commentDeleted",t.comment)},function(t){console.log(t)}))}},computed:{isAdmin:function(){return this.$store.state.isAdmin}}},a={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"comment"},[s("p",[s("span",{staticClass:"comment-text"},[s("span",{staticClass:"mutted"},[t._v(t._s(t.comment.username||"Usuário")+"\n      "),t.isAdmin?s("router-link",{staticClass:"edit-user-link",attrs:{tag:"a",to:{name:"dashboard.users.edit",params:{id:t.comment.user_id}}}},[s("md-icon",[t._v("edit")])],1):t._e()],1),t._v("\n      "+t._s(t.comment.text)+"\n      "),s("span",{staticClass:"mutted comment-time"},[t._v(t._s(t._f("timePassed")(t.comment.created_at)))]),t._v(" "),t.isAdmin?s("a",{staticClass:"delete-comment-link",attrs:{href:"#end-comments"},on:{click:function(e){return e.preventDefault(),t.destroy(e)}}},[s("md-icon",[t._v("delete")])],1):t._e()])])])},staticRenderFns:[]};var o=s("VU/8")(r,a,!1,function(t){s("9e/E")},"data-v-7d2f2c80",null).exports,c=s("YaEn"),d={props:["recipeId"],data:function(){return{text:"",sendClicked:!1,disableSend:!1,notCommented:!0,comments:[]}},methods:{sendComment:function(){if(this.sendClicked=!0,!this.invalidMessage){this.disableSend=!0;var t=this.$cookie.get("SecureToken");this.remote.recipes.comments.create(t,this.recipeId,this.text,this.commentCreated,this.commentErrorCreating)}},commentCreated:function(t){this.notCommented=!1,this.text=t.data.text,this.comments.push(t.data),window.scrollTo(0,document.body.scrollHeight)},commentErrorCreating:function(t){this.disableSend=!1,console.log("error",t)},canComment:function(){this.isAuth()||c.a.push({path:"/sign",query:{redirect:c.a.currentRoute.fullPath}})},removeComment:function(t){for(var e=0;e<this.comments.length;e++)if(this.comments[e]===t)return void this.comments.splice(e,1)}},computed:{invalidMessage:function(){return this.sendClicked&&this.text.length<10}},created:function(){var t=this;this.remote.recipes.comments.index(this.recipeId,function(e){t.comments=e.data})},components:{Comment:o}},m={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("md-card",{staticClass:"md-primary",attrs:{"md-theme":"comment-card"}},[s("md-card-content",[t.notCommented?s("div",[s("md-card-header",{staticClass:"md-transparent"},[s("h3",{staticClass:"md-title"},[t._v("Comentários")])]),t._v(" "),s("br"),t._v(" "),s("md-field",{class:{"md-invalid":t.invalidMessage}},[s("label",[t._v("Seu comentário")]),t._v(" "),s("md-textarea",{attrs:{required:"","md-autogrow":""},on:{focus:t.canComment},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}}),t._v(" "),s("span",{staticClass:"md-helper-text"},[t._v("Deixe sua opinião sobre esta receita")]),t._v(" "),s("span",{staticClass:"md-error"},[t._v("A mensagem deve ter no mínimo 10 caracteres")])],1),t._v(" "),s("div",{staticClass:"pull-rigth"},[s("md-button",{attrs:{disabled:t.disableSend},on:{click:t.sendComment}},[t._v("Comentar")])],1)],1):t._e(),t._v(" "),s("md-divider"),t._v(" "),t._l(t.comments,function(e){return s("comment",{key:"com"+e.id,attrs:{comment:e},on:{commentDeleted:t.removeComment}})})],2),t._v(" "),s("div",{attrs:{id:"end-comments"}})],1)},staticRenderFns:[]};var l=s("VU/8")(d,m,!1,function(t){s("L4Tr")},"data-v-95f9d95c",null).exports,u=s("X+2x"),p={props:["recipeId","averageStars"],data:function(){return{stars:0}},methods:{ratingSelected:function(t){this.isAuth()?this.remote.recipes.rating.create(this.recipeId,t,this.$cookie.get("SecureToken"),this.loadUserRating,this.loadUserRatingError):c.a.push({path:"/sign",query:{redirect:c.a.currentRoute.fullPath}})},loadUserRating:function(t){t.data&&(this.stars=t.data.stars)},loadUserRatingError:function(t){console.log(t)}},created:function(){this.stars=this.averageStars,this.isAuth()&&this.remote.recipes.rating.show(this.recipeId,this.$cookie.get("SecureToken"),this.loadUserRating,this.loadUserRatingError)},components:{StarRating:s.n(u).a}},v={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("star-rating",{attrs:{"star-size":25,"rounded-corners":"","show-rating":!1,padding:1},on:{"rating-selected":t.ratingSelected},model:{value:t.stars,callback:function(e){t.stars=e},expression:"stars"}})],1)},staticRenderFns:[]},h=s("VU/8")(p,v,!1,null,null,null).exports,_=s("NCSP"),f=s("mtWM"),g={mixins:[n.a],data:function(){return{recipe:{},isLoading:!0}},computed:{isAdmin:function(){return this.$store.state.isAdmin}},methods:{setRecipe:function(t){this.recipe=t.data,this.isLoading=!1,console.log(this.recipe)}},created:function(){f.get("https://sabre-api.herokuapp.com/api/v1/recipes/"+this.$route.params.id).then(this.setRecipe).catch(function(t){console.log(t)})},components:{Loading:i.a,Comments:l,Rating:h,FavoriteButton:_.a}},C={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.isLoading?s("loading"):s("div",{staticClass:"md-layout md-gutter md-alignment-top-center"},[s("md-card",{staticStyle:{"max-width":"680px"}},[s("md-card-media",[s("img",{attrs:{src:"/static/img/demo.jpg",alt:"Demo"}}),t._v(" "),t.isAdmin?s("md-button",{staticClass:"md-fab md-fab-top-left",attrs:{to:{name:"dashboard.recipes.edit",params:{id:t.recipe.id}}}},[s("md-icon",[t._v("edit")])],1):t._e(),t._v(" "),s("favorite-button",{staticClass:"favorite-button",attrs:{recipeId:t.recipe.id}})],1),t._v(" "),s("md-card-header",[s("div",{staticClass:"md-title"},[t._v(t._s(t.recipe.name))]),t._v(" "),s("div",{staticClass:"md-subhead"},[t._v("\n          "+t._s(t.recipe.owner)+"\n          "),t.isAdmin?s("router-link",{staticClass:"edit-user-link",attrs:{tag:"a",to:{name:"dashboard.users.edit",params:{id:t.recipe.user_id}}}},[s("md-icon",[t._v("edit")])],1):t._e(),t._v(" "),s("div",{staticClass:"md-subhead recipe-date"},[t._v(t._s(t._f("timePassed")(t.recipe.created_at)))])],1)]),t._v(" "),s("md-card-actions",[s("rating",{attrs:{recipeId:t.recipe.id,averageStars:t.recipe.average_stars}})],1),t._v(" "),s("md-card-content",{attrs:{id:"recipe-content"}},[s("div",[s("md-toolbar",{staticClass:"md-transparent"},[s("h3",{staticClass:"md-title"},[t._v("Ingredientes")])]),t._v(" "),s("br"),t._v(" "),s("ul",t._l(t.recipe.ingredients.split("\n"),function(e,i){return e?s("li",{key:"ing"+i},[t._v("\n              "+t._s(e)+"\n            ")]):t._e()})),t._v(" "),s("br"),s("br")],1),t._v(" "),s("div",[s("md-toolbar",{staticClass:"md-transparent"},[s("h3",{staticClass:"md-title"},[t._v("Modo de preparo")])]),t._v(" "),s("br"),t._v(" "),s("ol",t._l(t.recipe.directions.split("\n"),function(e,i){return s("li",{key:"dir"+i},[t._v("\n              "+t._s(e)+"\n            ")])})),t._v(" "),s("br")],1)]),t._v(" "),s("md-card-content",[s("comments",{attrs:{recipeId:t.recipe.id}})],1)],1)],1)],1)},staticRenderFns:[]};var b=s("VU/8")(g,C,!1,function(t){s("7PBn")},"data-v-3c685156",null);e.default=b.exports}});
//# sourceMappingURL=0.75d5a57a7025002f0dfd.js.map